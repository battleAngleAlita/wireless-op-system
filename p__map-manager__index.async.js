(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"Irv+":function(e,t,a){e.exports=a.p+"static/map.2f8cd447.png"},KYFU:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAD7klEQVRYR+2XXWgcVRTH/+duVCRYu5MGxYeKdG63WBVK81aUtH0QP6Co2Jf6EYs07F0TqUZQELq+VGigSsLORiW6iB9g3wqiQiVWQ1FRodSi7mz9yENekp3ZqoSS3blHZpNNp5udndkkj+7Tsvs///u799x7z7mEDj+bx+1+kaAhgB+thxJmwNjasCGiE4vCG/1nMDUfx5riiHyNMWHfCY2jAJ69NoYPA/Ru028OmMfhiZPOsPy73RiRAMaYvQkJ/QJI+INvumrG02AqOBk5aeSLj0Hz3SBxrGmwi2C84WvCIFoCbLF+TwFeymPeQURPAdgZZsAExTX8IhKYajPTL5iocKOonJ4d7FsI6loCGJbNMVPzGYAHYmqXZKxfczKp7MqeaRVs5OxJEA53ZBxTzIQn3LT8sC2A/2fSKh0B+AgBu2N6t5cRFomRLSv5emQKgoIO0hEKwBDpLr7ywVxm57/NouhTEH8/hAJoD3srQ/KrVoJIgA1Z/jYmkQBGrvQiEz+8HhBXyb0d3QNBcc/Epf2s9Zk1AxAuOGl5z5oBeicuSU/rIghZBnYR40AsGEIWjCwB+bKSas0A5ph9g9OFK2AuQIhzYH47aMZAfXMR0H/t8aIBBhcYfMhV2z9aM4AfaFil3wBc1lqPCEFng2aOkrRcqC42fmfgfYAuE3iIE+J2d3DbzPoAcsVPQbRvsYatXTd1Va9bWKjNeddX4ZhVZEm3vE0t+zsAZUfJB9ulLPIU+ME9ueIAE70Hpj1OxjwXtQe25O1+zZgi0HBZmePrBrhl9Hx3tbv7ZwZPu0o+GQVg5O2TYBxNMMm5jFlaN8DyPjgB8EsaOFBR8nSY6c3v/HlHorr4PUNMu8p8JAo2Vgp8k815e5dgfA3gL0fJu8KMDav4FkAH2RP3uUPbLmwYQH0vWPYrDBz3a3qoMYljfpPipmU+avDl4xtHdlVjWPYnDPSGRQlgtqzkobiusVMQ17Ch87tn/3tYFWzoIgGMXGmEiR8CMOMq+XQQJGkVxwh+iw40l1zDsv3La7vfppdF5VUM9lVbTSIUwMjb9zPj5eAVKzR2zz8nf/KNenN/3Fqj2scEuo3Bs8T6bKPXW3o7BJtU/gasjzuZHZ83Q6wCSI7/uocSiYHV/X89dNJRcuVd0JMv7WPmL/16ECy5hmX774RnVs2YqKCr3puV4dT5VSmo9/Ysngf43nb5FqC+eWX+WL8bcqUREI8yUHKVlEsrUzI90t8C1BN+UqjgpM064MoKJC17qrmitTIIDpa07B8CTetBR8lTRr54Bkz7200iuGIdAwSMTwF4vGkgvyKGPmIa2o0C6PRkruj/BwiuwH9vFJAw/mrXwwAAAABJRU5ErkJggg=="},fIZ0:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return g});var n=a("d6i3"),s=a.n(n),i=a("1l/V"),r=a.n(i),o=a("q1tI"),m=a.n(o),c=a("XV3Y"),h=a("LXeP"),u=a.n(h);class g extends m.a.Component{constructor(e){super(e),this.setupLampData=((e,t,a)=>{var n=1920,s=1080;return e.map(e=>({x:e.x/n*t,y:e.y/s*a}))}),this.map=m.a.createRef(),this.state={mapImage:null,icon:null,width:0,height:0,lamps:[]}}componentDidMount(){var e=this;return r()(s.a.mark(function t(){var a,n,i,r,o;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dynamicLoadMapImage();case 2:return a=t.sent,t.next=5,e.dynamicLoadIconImage();case 5:n=t.sent,i=e.map.current,r=i.clientWidth,o=i.clientHeight,e.connectWs(),e.setState({mapImage:a,icon:n,width:r,height:o});case 9:case"end":return t.stop()}},t)}))()}connectWs(){var e=this.map.current,t=e.clientWidth,a=e.clientHeight;this.ws=new WebSocket("ws://47.96.112.31:8084/jeecg-boot/websocket/1"),this.ws.onopen=(()=>{}),this.ws.onmessage=(e=>{var n=JSON.parse(e.data),s=n.msgTxt,i={x:+s.xCoordinate,y:+s.yCoordinate,id:s.lampNumber},r=this.setupLampData([i],t,a);this.setState({lamps:r})}),this.ws.onclose=(()=>{})}createLamps(){var e=this.state.lamps;return e.map((e,t)=>m.a.createElement(c["Image"],{image:this.state.icon,x:e.x-16,y:e.y-16,width:32,height:32,key:t}))}componentWillUnmount(){}dynamicLoadMapImage(){return new Promise(e=>{var t=new Image;t.src=a("Irv+"),t.onload=function(){e(t)}})}dynamicLoadIconImage(){return new Promise(e=>{var t=new Image;t.src=a("KYFU"),t.onload=function(){e(t)}})}render(){var e=this.state,t=e.mapImage,a=e.width,n=e.height,s=this.createLamps();return m.a.createElement("div",{className:u.a.map_manager,ref:this.map},m.a.createElement(c["Stage"],{width:a,height:n},m.a.createElement(c["Layer"],null,m.a.createElement(c["Image"],{image:t,x:0,y:0,width:a,height:n}),s)))}}}}]);